<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brihas.IA - Chat Experience</title>
    <!-- Bootstrap CSS for easy styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts for better typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .chat-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 800px;
            margin: 0 auto;
            height: 80vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
        }

        .message.bot .message-content {
            background: rgba(86, 75, 216, 0.3);
            border-top-left-radius: 4px;
        }

        .message.user .message-content {
            background: rgba(66, 153, 225, 0.3);
            border-top-right-radius: 4px;
        }

        .chat-input {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-input .input-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 24px;
            padding: 5px;
        }

        .chat-input input {
            background: transparent;
            border: none;
            color: white;
            padding: 10px 15px;
        }

        .chat-input input:focus {
            box-shadow: none;
            background: transparent;
        }

        .chat-input button {
            border-radius: 20px;
            padding: 8px 20px;
        }

        /* Name modal styling */
        .name-modal .modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .name-modal .modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .name-modal .btn-close {
            filter: invert(1);
        }

        .name-modal .form-control {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 16px;
        }

        .name-modal .form-control::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .name-modal .form-control:focus {
            background-color: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 0.25rem rgba(255, 255, 255, 0.25);
            color: white;
        }

        .typing-indicator {
            display: flex;
            padding: 12px 16px;
            background: rgba(86, 75, 216, 0.3);
            border-radius: 18px;
            width: fit-content;
            margin-bottom: 15px;
        }

        .typing-indicator span {
            height: 8px;
            width: 8px;
            background: white;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            opacity: 0.6;
            animation: bounce 1.3s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.15s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.3s;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        .timestamp {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 4px;
            text-align: right;
        }

        .suggestion-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .suggestion-chip {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 6px 12px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .suggestion-chip:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- Name Entry Modal -->
    <div class="modal fade name-modal show" id="nameModal" tabindex="-1" aria-labelledby="nameModalLabel" aria-hidden="false" data-bs-backdrop="static" data-bs-keyboard="false" style="display: block; padding-right: 15px;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold" id="nameModalLabel">Welcome to Brihas.IA</h5>
                </div>
                <div class="modal-body">
                    <p class="mb-3">To get started, please enter your name:</p>
                    <form id="nameForm">
                        <div class="mb-3">
                            <input type="text" class="form-control" id="userName" placeholder="Your name" required autocomplete="off">
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">Start Chatting</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-backdrop fade show" id="backdrop" style="display: block;"></div>

    <!-- Chat Interface (initially hidden) -->
    <div class="chat-container" id="chatInterface" style="display: none;">
        <div class="chat-header">
            <h3>Brihas.IA</h3>
            <p class="mb-0">Your AI companion for self-discovery</p>
        </div>
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be added here dynamically -->
        </div>
        <div class="chat-input">
            <div class="input-group">
                <input type="text" class="form-control" id="messageInput" placeholder="Type your message here..." autocomplete="off">
                <button class="btn btn-primary" type="button" id="sendButton">
                    <i class="bi bi-send-fill"></i>
                </button>
            </div>
            <div class="suggestion-chips mt-2" id="suggestionChips">
                <div class="suggestion-chip" data-message="I'm feeling anxious today">I'm feeling anxious today</div>
                <div class="suggestion-chip" data-message="How can I improve my mood?">How can I improve my mood?</div>
                <div class="suggestion-chip" data-message="I need help with stress">I need help with stress</div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Initialize the name modal
        const nameModal = new bootstrap.Modal(document.getElementById('nameModal'), {
            backdrop: 'static',
            keyboard: false
        });
        nameModal.show();

        // Handle name form submission
        document.getElementById('nameForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const userName = document.getElementById('userName').value.trim();
            if (userName) {
                // Store the user's name
                localStorage.setItem('brihasUserName', userName);

                // Hide the modal and show the chat interface
                nameModal.hide();
                document.getElementById('backdrop').style.display = 'none';
                document.getElementById('chatInterface').style.display = 'flex';

                // Show welcome message
                addMessage('bot', `Hello ${userName}! I'm Brihas, your AI companion for self-discovery. How are you feeling today?`);
            }
        });

        // Handle sending messages
        document.getElementById('sendButton').addEventListener('click', sendMessage);
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Handle suggestion chips
        document.querySelectorAll('.suggestion-chip').forEach(chip => {
            chip.addEventListener('click', function() {
                document.getElementById('messageInput').value = this.getAttribute('data-message');
                sendMessage();
            });
        });

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();

            if (message) {
                // Add user message to chat
                addMessage('user', message);
                messageInput.value = '';

                // Show typing indicator
                const typingIndicator = document.createElement('div');
                typingIndicator.className = 'message bot';
                typingIndicator.innerHTML = `
                    <div class="message-content typing-indicator">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                `;
                document.getElementById('chatMessages').appendChild(typingIndicator);
                document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;

                // Generate AI response after a short delay
                setTimeout(() => {
                    // Remove typing indicator
                    document.getElementById('chatMessages').removeChild(typingIndicator);

                    // Add AI response
                    const aiResponse = generateAIResponse(message);
                    addMessage('bot', aiResponse);
                }, 1500);
            }
        }

        function addMessage(sender, text) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;

            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            messageElement.innerHTML = `
                <div class="message-content">
                    ${text}
                    <div class="timestamp">${timeString}</div>
                </div>
            `;

            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function generateAIResponse(userMessage) {
            // Convert to lowercase for easier matching
            const message = userMessage.toLowerCase();

            // Response patterns based on message content
            if (message.includes('anxious') || message.includes('anxiety') || message.includes('nervous')) {
                return "I understand anxiety can be challenging. Try taking a few deep breaths - inhale for 4 seconds, hold for 4, exhale for 6. What specifically is making you feel anxious right now?";
            }
            else if (message.includes('stress') || message.includes('stressed') || message.includes('overwhelm')) {
                return "Stress is your body's response to challenges. Breaking tasks into smaller steps can help. Would you like to try a quick grounding exercise?";
            }
            else if (message.includes('sad') || message.includes('depress') || message.includes('unhappy')) {
                return "I'm sorry you're feeling this way. It's okay to not be okay sometimes. Would talking about what's bothering you help?";
            }
            else if (message.includes('happy') || message.includes('good') || message.includes('great')) {
                return "That's wonderful to hear! Celebrating positive moments is important. What's contributing to these good feelings?";
            }
            else if (message.includes('angry') || message.includes('mad') || message.includes('frustrat')) {
                return "Anger is a natural emotion that often signals a boundary has been crossed. What triggered this response for you?";
            }
            else if (message.includes('tired') || message.includes('exhaust') || message.includes('fatigue')) {
                return "Rest is essential for wellbeing. Are you getting enough sleep? Sometimes fatigue can be emotional as well as physical.";
            }
            else if (message.includes('help') || message.includes('support')) {
                return "I'm here to listen and help you explore your thoughts. What would be most helpful for you right now - practical suggestions or just a space to talk?";
            }
            else if (message.includes('hello') || message.includes('hi ') || message.includes('hey')) {
                return "Hello there! How are you feeling today?";
            }
            else {
                // Default responses for other messages
                const responses = [
                    "I understand how you're feeling. Can you tell me more about what's been on your mind lately?",
                    "That's interesting. How has that been affecting your daily life?",
                    "I appreciate you sharing that with me. What do you think is the root cause of these feelings?",
                    "Many people experience similar emotions. What strategies have you tried to cope with this?",
                    "Thank you for being open. How would you like to feel instead?",
                    "I hear you. What's one small step you could take today to address this?",
                    "Your self-awareness is commendable. What support do you need right now?",
                    "I'm here to listen without judgment. What else would you like to share?",
                    "It takes courage to explore these feelings. What insights have you gained so far?",
                    "I'm curious to know more about your perspective. How long have you been feeling this way?"
                ];

                // Simple response based on message length and a random selection
                const randomIndex = Math.floor(Math.random() * responses.length);
                return responses[randomIndex];
            }
        }

        // Check if user already has a name stored
        window.addEventListener('DOMContentLoaded', function() {
            const storedName = localStorage.getItem('brihasUserName');
            if (storedName) {
                nameModal.hide();
                document.getElementById('backdrop').style.display = 'none';
                document.getElementById('chatInterface').style.display = 'flex';
                addMessage('bot', `Welcome back ${storedName}! How have you been since we last spoke?`);
            }
        });
    </script>
</body>
</html>
